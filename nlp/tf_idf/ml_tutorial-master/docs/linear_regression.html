---

title: Linear Regression

keywords: fastai
sidebar: home_sidebar

summary: "This tutorial describes linear regression technique and demonstrates how it works via an example of fitting a curve using linear regression."
description: "This tutorial describes linear regression technique and demonstrates how it works via an example of fitting a curve using linear regression."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_linear_regression.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Definition">Definition<a class="anchor-link" href="#Definition"> </a></h2><p>Regression is an approach to modeling the relationship between a real-valued target $y$ (dependent variable) and data points $X$ (independent variables). In other words, linear regression describes the relationship between input and output and predicts the output based on the input data.
{% include note.html content='$X$ is a vector of features, i.e. $X = &lt;x_1, x_2,\cdots, x_n&gt;$' %}
Examples of linear regression include, predicting the weight from gender, age, and height, or predicting the stock price today from the prices of yesterday.</p>
<p>We wish to learn $f:X\to Y$, where $Y$ is a real number, given $\{&lt;X^1,y^1&gt;,\cdots, &lt;X^m,y^m&gt;\}$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression-Intuition">Linear Regression Intuition<a class="anchor-link" href="#Linear-Regression-Intuition"> </a></h2><h3 id="How-much-is-my-house-worth?">How much is my house worth?<a class="anchor-link" href="#How-much-is-my-house-worth?"> </a></h3><p>{% include image.html max-width="700" file="/ml_tutorial/images/linear_regression_1.svg" %}</p>
<!-- ![](img/linear_regression_1.svg) -->
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Compare-Prices-of-Other-Houses">Compare Prices of Other Houses<a class="anchor-link" href="#Compare-Prices-of-Other-Houses"> </a></h3><p>Intuitively, we plot the recent houses (e.g. last two years), and check how much other houses are sold.</p>
<p>{% include image.html max-width="700" file="/ml_tutorial/images/linear_regression_2.svg" %}
<!-- ![](img/linear_regression_2.svg) --></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check the prices of the sold houses that have the <em>same</em> square feet as my house.</p>
<!-- ![](img/linear_regression_3.svg) -->

<p>{% include image.html max-width="700" file="/ml_tutorial/images/linear_regression_3.svg" %}</p>
<p>What if no house was sold with exactly the same size?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I look at some small range of square footage around my actual square footage, and check the houses within this range.</p>
<!-- ![](img/linear_regression_4.svg) -->

<p>{% include image.html max-width="700" file="/ml_tutorial/images/linear_regression_4.svg" %}</p>
<p>The problem is, I am only considering a few houses and throwing out all other observations as if they have nothing to do with the value of my house.</p>
<p>We can leverage all the information we can from all the observations to  come up with a good prediction.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression-Model">Linear Regression Model<a class="anchor-link" href="#Linear-Regression-Model"> </a></h2><p>{% include image.html max-width="700" file="/ml_tutorial/images/linear_regression_5.svg" %}</p>
<!-- ![](img/linear_regression_5.svg) -->
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Formal-Problem-Description">Formal Problem Description<a class="anchor-link" href="#Formal-Problem-Description"> </a></h3><p>Let's assume that we are going to predict the price of houses (in dollars), $y$, based on their area (in square feet), $x$. Therefore, training set = $\{&lt;x^1,y^1&gt;,\cdots,&lt;x^m,y^m&gt;\}$, where:</p>
<ul>
<li>$m$: number of trainig examples</li>
</ul>
<ul>
<li>$x$: input variable</li>
</ul>
<ul>
<li>$y$: output variable or target label</li>
</ul>
<ul>
<li>$(x^i,y^i)$: is the $i$th training example</li>
</ul>
<p>{% raw %}
$$\hat y = f(x) = w_0 + w_1x$$
{% endraw %}</p>
<p>where $w_0$ and $w_1$ are the paramaters of the $f(x)$ that we need to find.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Which-Line-to-Choose?">Which Line to Choose?<a class="anchor-link" href="#Which-Line-to-Choose?"> </a></h3><p>{% include image.html max-width="700" file="/ml_tutorial/images/linear_regression_6.svg" %}</p>
<!-- ![](img/linear_regression_6.svg) -->
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Compute-Cost">Compute Cost<a class="anchor-link" href="#Compute-Cost"> </a></h3><p>We define the cost as the Residual Sum of Squares (RSS), which is:</p>
<p>{% raw %}
$$RSS(w_0,w_1)=\sum_{i=1}^{m}(y_i-[w_0+w_1x_i])^2$$
{% endraw %}</p>
<p>We <em>minimize</em> the cost over all possible values of $w_0$ and $w_1$.</p>
<p>{% include image.html max-width="700" file="/ml_tutorial/images/linear_regression_7.svg" %}</p>
<!-- ![](img/linear_regression_7.svg) -->
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fit-Data-with-a-Line-or-...?">Fit Data with a Line or ...?<a class="anchor-link" href="#Fit-Data-with-a-Line-or-...?"> </a></h2><p>We might consider a quadratic function or even higher order polynomial function to fit the data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Generate some random data</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">number_of_points</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">number_of_points</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">number_of_points</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;square feet&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>

<span class="c1"># Define the chart</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;square feet&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_poly</span><span class="p">(</span><span class="n">degree</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">base</span> <span class="o">+</span> <span class="n">base</span><span class="o">.</span><span class="n">transform_regression</span><span class="p">(</span>
        <span class="s2">&quot;square feet&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;poly&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">degree</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">plot_poly</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html height="500" align="left" max-width="500" file="/ml_tutorial/images/lr_house_line_ex.png" %}</p>
<p>{% include image.html height="500" align="right" max-width="500" file="/ml_tutorial/images/lr_house_ex.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Polynomial-Regression-Model">Polynomial Regression Model<a class="anchor-link" href="#Polynomial-Regression-Model"> </a></h2><p>If we represent the relationship between the independent variable $x$ and dependent variable $y$ as an $n$th degree polynomial, then the regression model is called <strong>polynomial regression</strong>. Therefore, we have:</p>
<p>{% raw %}
$$y_i=w_0+w_1x_i+w_2x_i^2+\cdots+w_nx_i^n+\epsilon_i$$
{% endraw %}</p>
<p>We treat each $x_i^p$ for $p=1,\cdots,n$ as a different feature. i.e. $feature\ 1=x, feature\ 2=x^2,\cdots, feature\ n=x^n$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overfitting-Problem">Overfitting Problem<a class="anchor-link" href="#Overfitting-Problem"> </a></h2><p>We fit a quadratic function and look at the plot and notice that quadratic fit is better than a line. Then, we might think a higher order polynomial even fits the data better. We try 13th order polynomial and minimize the residual sum of squares. The residual sum of error is quite small, which means this 13th order polynomial is the best fit for the data. However, based on this function the price my house is unrealistically low whereas I think my house isn't worth so little.</p>
<p>{% include image.html height="700" file="/ml_tutorial/images/linear_regression_2_13.svg" %}</p>
<!-- ![](img/linear_regression_2_13.svg) -->

<p>Quadratic function: $\hat{y}=w_0+w_1x+w_2x^2$, and 13th order polynomial: $\hat{y}=w_0+w_1x+w_2x^2+\cdots w_{13}x^{13}$</p>
<p>The reason is this 13th order polynomial is <em>overfitting</em> the data. It means even though our model fits the observations really well, it doesn't generalize well to predicting new observations. It minimizes
the residual sum of squares, but it ends up leading to very bad predictions. Although, the quadratic function didn't minimize residual sum of squares as much as the 13th order polynomial, it still is a better model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-Prevent-Overfitting">How to Prevent Overfitting<a class="anchor-link" href="#How-to-Prevent-Overfitting"> </a></h2><p>Considering our dataset, we remove some of the houses and fit the model on the remaining ones. We minimize the RSS error. Then, we predict the values of the held-out houses (i.e. the houses we left out) and compare the predicted values with their actual values.</p>
<p>The dataset (e.g houses) that we use to fit the model is called <strong>Training set</strong>. And the dataset that we use for prediction (held-out) is called <strong>Test set</strong>.</p>
<p>In order to see how well our model works, we do a little bit of analysis. We look at the residual sum of squares on the houses in our training set that is called <strong>training error</strong>. We then estimate the model parameters $w=[w_0,w_1]$. We take these estimated parameters and see how well we predicting the actual values of the houses that are in test set. We use the predicted value (value on the line) and again we look at the residual sum of squares over all the houses that are in the test set, and is called <strong>test error</strong>. Then, we assess how the test error and training error vary as function of the model complexity.</p>
<p>{% include image.html max-width="700" file="/ml_tutorial/images/linear_regression_tr_test.svg" %}</p>
<!-- ![](img/linear_regression_tr_test.svg) -->

<p>If we notice that there is a big difference between training error and test error, it means that model is likely overfitted. Another sign of overfitting is that the parameter values $w$ are very large.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Regularization">Regularization<a class="anchor-link" href="#Regularization"> </a></h3><p>We add a penalty term to the Residual sum of squares (RSS). This extra term penalizes the parameters $w$ from getting large values. Therefore, instead of minimizing the RSS, we minimize the combination of RSS and this additional regularization expression.</p>
<p>{% raw %}
$$J(\mathbf{w})=\sum_{i=1}^{m}\Big( y_i-f(x_i)\Big)^2+\lambda\|\mathbf{w}\|^2$$
{% endraw %}</p>
<p>where $\|\mathbf{w}\|^2 = \sqrt{w_1^2 +w_2^2+\cdots w_k^2}$, and $\lambda$ is a hyperparameter that balances tradeoff.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression-General-Expansion">Linear Regression General Expansion<a class="anchor-link" href="#Linear-Regression-General-Expansion"> </a></h2><p>In general, if we have a dataset of $m$ instances with $k$ features, $\mathbf{x}=&lt;x_1,x_2,\cdots,x_k&gt;$ and a real valued target $y$, then the linear regression model takes the form:</p>
<p>{% raw %}
$$y_i=w_0+w_1h_1(x_1)+w_2h_2(x_2)+\cdots+w_kh_k(x_k)+\epsilon_i= w_0 +\sum_{j=1}^{k}w_jh_j(x_i)+\epsilon_i$$
{% endraw %}</p>
<p>Considering our house price prediction, instead of using only area of the house, we can add more features such as number of bathrooms, number of bedrooms, age of the house, etc.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Regression-Problem-Statement">The Regression Problem Statement<a class="anchor-link" href="#The-Regression-Problem-Statement"> </a></h2><p>The general approach is as follows:</p>
<ul>
<li><p>Instances: $&lt;\mathbf{x}_i,y_i&gt;$</p>
</li>
<li><p>Learn: mapping from $\mathbf{x}$ to $y\equiv f(\mathbf{x})$</p>
</li>
<li><p>Given the basis functions $h_1, h_2,\cdots,h_k$ where $h_j(\mathbf{x})\in \mathbb{R}$</p>
</li>
<li><p>Find coeffcients $\mathbf{w}=[w_0,w_1,\cdots,w_k]$, where $f(\mathbf{x})\thickapprox \hat{f}(\mathbf{x})=w_0+\sum_{j}w_jh_j(\mathbf{x})$</p>
</li>
</ul>
<ul>
<li>In order to find coefficients, we need to minimize the <strong>mean residual square error</strong>:</li>
</ul>
<p>{% raw %}
$$J(\mathbf{w}) = \frac{1}{m}\sum_{i=1}^{m}\left( f(\mathbf{x}_i) - \left(w_0 +\sum_{j=1}^{k}w_jh_j(\mathbf{x})\right)\right)^2$$
{% endraw %}</p>
<p>{% raw %}
$$\mathbf{w}^* = \underset{\mathbf{w}}{\arg\min}\ J(\mathbf{w})$$
{% endraw %}
{% include note.html content='The reason it&#8217;s called <em>linear</em> regression is that the model is a linear combinations of the input features.' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-Fit-a-Line-to-Two-Diminsional-Data">Example: Fit a Line to Two Diminsional Data<a class="anchor-link" href="#Example:-Fit-a-Line-to-Two-Diminsional-Data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We would like to find a <strong>line</strong> that <strong>fits</strong> our training examples the <strong>best</strong>.</p>
<p>{% include image.html height="500" max-width="500" file="/ml_tutorial/images/linear_regression_ex_model.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we are looling for a line to fit our training set, we need to find a function $\hat y = f(x)$ that estimates $y^i$ for all $1\leq i \leq m$. Thus, we have:</p>
<p>{% raw %}
$$\hat y = f(x) = w_0 + w_1x$$
{% endraw %}</p>
<p>$w_0$ and $w_1$ are the paramaters that we need to find.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cost-Function-(Error-Function)">Cost Function (Error Function)<a class="anchor-link" href="#Cost-Function-(Error-Function)"> </a></h2><p>We wish to estimate the actual $y$, i.e. we want to minimize the error as much as possible. The error is the difference between the actual $y^i$ and our estimated/predicted $\hat{y}^i$ for all $1\leq i \leq m$.</p>
<p>The error/cost function is:</p>
<p>{% raw %}
$$J(w_0,w_1) = \frac{1}{m}\sum_{i=1}^{m}\left( y^i - (w_0 + w_1 x^i)\right)^2$$
{% endraw %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Precisely, we need to minimize the <strong>mean residual squared error</strong>:</p>
<p>{% raw %}
$$\text{minimize } J(w_0,w_1) = \underset{w0,w_1}{\arg\min} \frac{1}{m}\sum_{i=1}^{m}\left( \hat{y}^i - (w_0 + w_1 x^i)\right)^2$$
{% endraw %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fitting-the-Linear-Regression-Model-using-Gradient-Descent-Algorithm">Fitting the Linear Regression Model using Gradient Descent Algorithm<a class="anchor-link" href="#Fitting-the-Linear-Regression-Model-using-Gradient-Descent-Algorithm"> </a></h2><p>In order to mininze the cost function, we need to take the gradient (i.e. derivative) of the function with resptect to our parameters $w_0$ and $w_1$, set it zero and solve for $w_0$ and $w_1$.</p>
<p>{% raw %}
$$\frac{\partial{J}}{\partial{w_0}} = \frac{-2}{m} \sum_{i=1}^{m}\left(\hat{y}^i - (w_0 + w_1 x^i)\right)$$
{% endraw %}</p>
<p>{% raw %}
$$\frac{\partial{J}}{\partial{w_1}} = \frac{-2}{m} \sum_{i=1}^{m}x^i\left(\hat{y}^i - (w_0 + w_1 x^i)\right)$$
{% endraw %}</p>
<p>{% include image.html max-width="500" file="/ml_tutorial/images/gradient_descent.png" %}</p>
<p><em>image source: <a href="https://towardsdatascience.com/gradient-descent-algorithm-and-its-variants-10f652806a3">https://towardsdatascience.com/gradient-descent-algorithm-and-its-variants-10f652806a3</a></em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-gradient-descent-algorithm:">The gradient descent algorithm:<a class="anchor-link" href="#The-gradient-descent-algorithm:"> </a></h2><p>initialize $w_0^{(0)} = w_1^{(0)} = 0$, for $t=0$</p>
<p>for $t=1$ to <em>num_iterations</em></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$w_0^{(t+1)} = w_0^{(t)} - \eta \frac{-2}{m} \sum_{i=1}^{m}\left(\hat{y}^i - (w_0 + w_1 x^i)\right) $</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$w_1^{(t+1)} = w_1^{(t)} - \eta\frac{-2}{m} \sum_{i=1}^{m}x^i\left(\hat{y}^i - (w_0 + w_1 x^i)\right)$</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t = t+1$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Implemented-Functions">Implemented Functions<a class="anchor-link" href="#Implemented-Functions"> </a></h2><p>All the functions, their implementations and documentations are described below.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_data" class="doc_header"><code>generate_data</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_data</code>(<strong><code>n</code></strong>)</p>
</blockquote>
<p>It generates dummy data.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_point_plot" class="doc_header"><code>make_point_plot</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_point_plot</code>(<strong><code>x</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>
<p>It plots the point chart of the data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_line_plot" class="doc_header"><code>make_line_plot</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_line_plot</code>(<strong><code>x</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>
<p>It plots the line chart of the data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="gradient_descent" class="doc_header"><code>gradient_descent</code><a href="https://github.com/sci2lab/ml_tutorial/tree/master/ml_tutorial/linear_regression.py#L42" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>gradient_descent</code>(<strong><code>data</code></strong>, <strong><code>w_0_t</code></strong>, <strong><code>w_1_t</code></strong>, <strong><code>learning_rate</code></strong>, <strong><code>num_iterations</code></strong>)</p>
</blockquote>
<p>Gradient descent implementation, which gets <code>data</code>, starting <code>w_0</code> and <code>w_1</code>, <code>learning_rate</code>
and the number of iterations <code>num_iterations</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Run-an-Example">Run an Example<a class="anchor-link" href="#Run-an-Example"> </a></h2><p>In this example, we generate some linear-looking data and then find the line that fits the data. The function that we use to generate the data is $y=5+3x+\text{Gaussian noise}$. Our goal is to find $\theta=[w_0,w_1]$ where $w_0=5$ and $w_1=3$ or close enough, as we have noise and it makes it impossible to recover the exact paratmeters of the function. We use the <a href="/ml_tutorial/rnn#generate_data"><code>generate_data</code></a> function to generate the training data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Approximate y = 5 + 3x</span>
<span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">generate_data</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The chart below shows the generated dataset.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">origin_chart</span> <span class="o">=</span> <span class="n">make_point_plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="c1">#show the chart</span>
<span class="n">origin_chart</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-b25208df9f04454cb7a0850e4434ea68"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    const outputDiv = document.getElementById("altair-viz-b25208df9f04454cb7a0850e4434ea68");
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-d77d4f31777d11718b31df3feb164da9"}, "mark": {"type": "point", "color": "red", "filled": true, "size": 50}, "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.0.2.json", "datasets": {"data-d77d4f31777d11718b31df3feb164da9": [{"x": 0.8057606627582843, "y": 5.667516515220155}, {"x": 0.7085966002126411, "y": 7.468470203965426}, {"x": 1.0012286388859064, "y": 9.156721719221363}, {"x": 0.8903532576622766, "y": 7.41862373646544}, {"x": 0.1808655763928717, "y": 6.523917516129846}, {"x": 0.5471258400548813, "y": 7.155596361559026}, {"x": 1.8869541954854538, "y": 10.882042255677762}, {"x": 0.05308928266788393, "y": 4.089224517435358}, {"x": 0.07999737928130157, "y": 5.050496307020729}, {"x": 0.5662807194396391, "y": 6.953843602592299}, {"x": 1.1646883404335377, "y": 8.03603803579799}, {"x": 1.9817856058496541, "y": 11.380520305671855}, {"x": 1.9852844748059362, "y": 10.372258374095145}, {"x": 1.9862347449620896, "y": 11.775551306572048}, {"x": 0.22009666193312594, "y": 6.333010791509039}, {"x": 1.3289628919278802, "y": 8.882477532393013}, {"x": 1.0479736689766257, "y": 7.6126406300779665}, {"x": 0.34629981961746203, "y": 7.068632143985733}, {"x": 1.8859204898300514, "y": 10.219625846785737}, {"x": 0.4837201719525046, "y": 5.332842269602078}, {"x": 1.997864537686424, "y": 12.612575273734532}, {"x": 1.1653876302997974, "y": 10.037768065412799}, {"x": 0.36655800126115157, "y": 5.847794864570242}, {"x": 0.7736908438355805, "y": 6.478636793255444}, {"x": 0.3793470578242992, "y": 6.32255986403684}, {"x": 0.82154134605062, "y": 8.401706239260813}, {"x": 1.1893601378034109, "y": 9.299080757245042}, {"x": 1.4331721862566797, "y": 10.66107268391537}, {"x": 0.973782964738247, "y": 7.595110835012439}, {"x": 0.6191796355334092, "y": 6.913214921455005}, {"x": 1.1548827456556947, "y": 8.68704784552239}, {"x": 0.8834156391374859, "y": 6.207029922187122}, {"x": 0.7193562052010725, "y": 6.401716310008782}, {"x": 0.6426638640176272, "y": 7.744445603072168}, {"x": 0.4164144803920453, "y": 6.999688202710314}, {"x": 0.9025172481236687, "y": 7.251604816903004}, {"x": 0.9836858205281078, "y": 9.14067972961345}, {"x": 1.7981526295874224, "y": 8.703841062378665}, {"x": 1.4587209220588824, "y": 8.019763717315335}, {"x": 1.540179545839391, "y": 8.388104123603247}, {"x": 0.7508784951239764, "y": 6.708196323699465}, {"x": 0.6874790704707687, "y": 6.394265474598878}, {"x": 1.3100704119986448, "y": 8.937525799224836}, {"x": 1.422075986420995, "y": 8.653289223784821}, {"x": 0.2270751504373525, "y": 6.980973526067366}, {"x": 0.2660573787471501, "y": 4.065076512588169}, {"x": 0.9120781152122479, "y": 6.7529242465071135}, {"x": 0.31947246031702026, "y": 6.315925134118427}, {"x": 1.9232838075492915, "y": 9.1562729198257}, {"x": 1.6752314897236196, "y": 11.496408335782988}, {"x": 1.0403213740758466, "y": 6.932946524909822}, {"x": 0.4365445154563088, "y": 5.759887352833437}, {"x": 0.26983744506479757, "y": 4.8694661736496245}, {"x": 1.9581406909677377, "y": 10.046489708537342}, {"x": 1.4140869913782863, "y": 9.351124441968537}, {"x": 1.7199511138913262, "y": 10.667662932166298}, {"x": 0.7743452556572781, "y": 6.460808420461355}, {"x": 0.5016680396634496, "y": 7.754473861717328}, {"x": 0.5988760378894045, "y": 6.717016867750814}, {"x": 1.7137910568100314, "y": 9.25164168916506}, {"x": 0.9459679811364421, "y": 6.956105553926309}, {"x": 1.3265540940322564, "y": 8.99830123158483}, {"x": 1.6114572148735704, "y": 10.072216266544332}, {"x": 0.5059610092994482, "y": 6.531431576526956}, {"x": 0.15914687794064974, "y": 3.8419112344411275}, {"x": 1.4655212100314303, "y": 8.352353752384975}, {"x": 1.922794955007211, "y": 11.38142374670918}, {"x": 1.9076094683353255, "y": 11.459033618329801}, {"x": 0.9809981037677993, "y": 8.969915750703189}, {"x": 1.2643841288655102, "y": 7.360961775537605}, {"x": 1.4659900396759846, "y": 7.556781818841236}, {"x": 1.8048190064959324, "y": 10.7805502456551}, {"x": 0.32449383749640015, "y": 5.641704377436392}, {"x": 0.8117626447351225, "y": 6.7460699561156146}, {"x": 0.8341814711673217, "y": 9.5371519750069}, {"x": 1.3911820565841477, "y": 8.62283175783785}, {"x": 0.8496944758496632, "y": 8.299536757875831}, {"x": 1.7162284521028595, "y": 8.84169301722776}, {"x": 1.693864959218838, "y": 10.662168213450787}, {"x": 0.14039822781737765, "y": 4.31667159078984}, {"x": 0.603504826968297, "y": 7.500635951129598}, {"x": 1.9592473620603403, "y": 11.564632152319426}, {"x": 0.07125399310606961, "y": 3.6470744497398178}, {"x": 0.9847852939971642, "y": 8.859330003458174}, {"x": 1.9047537060270927, "y": 11.493083517404346}, {"x": 1.6211475170589422, "y": 10.291675421773569}, {"x": 0.5886608825927424, "y": 6.874854637676141}, {"x": 1.1924670370366823, "y": 8.60568474593312}, {"x": 0.8623557045994599, "y": 7.008241289007391}, {"x": 1.1847950059779726, "y": 7.354933818739986}, {"x": 1.787504209440412, "y": 8.656560622583067}, {"x": 1.1080423795434124, "y": 8.693291095737242}, {"x": 0.9857330146905476, "y": 9.833772471033809}, {"x": 0.6385409143790024, "y": 6.538719392968032}, {"x": 0.526731566101448, "y": 8.41213078012988}, {"x": 1.0845612270715916, "y": 8.256701115245988}, {"x": 0.16452904786404798, "y": 5.417563677867521}, {"x": 1.271273419650797, "y": 8.81777785293999}, {"x": 1.5928104503724156, "y": 9.593417240220132}, {"x": 1.9094950108616178, "y": 8.241333497362083}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We set the initial parameters to 0:  $w_0^{(0)} = w_1^{(0)} = 0$, define the number of iterations of the graditent descent algorithm as well as the learning rate. Then, we run the <a href="/ml_tutorial/linear_regression#gradient_descent"><code>gradient_descent</code></a> function. The outputs of this function are the estimated parameters $w_0$ and $w_1$.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">initial_w_0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">initial_w_1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">num_iterations</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span> <span class="o">=</span> <span class="n">gradient_descent</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">initial_w_0</span><span class="p">,</span><span class="n">initial_w_1</span><span class="p">,</span><span class="n">learning_rate</span><span class="p">,</span><span class="n">num_iterations</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;w_0 = </span><span class="si">{}</span><span class="s2">, w_1 = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>w_0 = [4.92304901], w_1 = [2.97394648]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The estimated parameters are $w_0 = 4.923$ and $w_1 = 2.97$ that are close enough to $w_0=5$ and $w_1=3$. Let's plot the line.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_predicted</span> <span class="o">=</span> <span class="n">w_0</span> <span class="o">+</span> <span class="n">w_1</span> <span class="o">*</span> <span class="n">X</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">make_line_plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y_predicted</span><span class="p">)</span>

<span class="c1">#show the charts</span>
<span class="n">origin_chart</span> <span class="o">+</span> <span class="n">line</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

<div id="altair-viz-d3c1b6e759444a6cacf374e677ca0fe5"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    const outputDiv = document.getElementById("altair-viz-d3c1b6e759444a6cacf374e677ca0fe5");
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.0.2?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"data": {"name": "data-d77d4f31777d11718b31df3feb164da9"}, "mark": {"type": "point", "color": "red", "filled": true, "size": 50}, "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}}, {"data": {"name": "data-fe04dd34dbf1c590d7ac876197c4c736"}, "mark": {"type": "line", "size": 3}, "encoding": {"x": {"type": "quantitative", "field": "x"}, "y": {"type": "quantitative", "field": "y"}}}], "$schema": "https://vega.github.io/schema/vega-lite/v4.0.2.json", "datasets": {"data-d77d4f31777d11718b31df3feb164da9": [{"x": 0.8057606627582843, "y": 5.667516515220155}, {"x": 0.7085966002126411, "y": 7.468470203965426}, {"x": 1.0012286388859064, "y": 9.156721719221363}, {"x": 0.8903532576622766, "y": 7.41862373646544}, {"x": 0.1808655763928717, "y": 6.523917516129846}, {"x": 0.5471258400548813, "y": 7.155596361559026}, {"x": 1.8869541954854538, "y": 10.882042255677762}, {"x": 0.05308928266788393, "y": 4.089224517435358}, {"x": 0.07999737928130157, "y": 5.050496307020729}, {"x": 0.5662807194396391, "y": 6.953843602592299}, {"x": 1.1646883404335377, "y": 8.03603803579799}, {"x": 1.9817856058496541, "y": 11.380520305671855}, {"x": 1.9852844748059362, "y": 10.372258374095145}, {"x": 1.9862347449620896, "y": 11.775551306572048}, {"x": 0.22009666193312594, "y": 6.333010791509039}, {"x": 1.3289628919278802, "y": 8.882477532393013}, {"x": 1.0479736689766257, "y": 7.6126406300779665}, {"x": 0.34629981961746203, "y": 7.068632143985733}, {"x": 1.8859204898300514, "y": 10.219625846785737}, {"x": 0.4837201719525046, "y": 5.332842269602078}, {"x": 1.997864537686424, "y": 12.612575273734532}, {"x": 1.1653876302997974, "y": 10.037768065412799}, {"x": 0.36655800126115157, "y": 5.847794864570242}, {"x": 0.7736908438355805, "y": 6.478636793255444}, {"x": 0.3793470578242992, "y": 6.32255986403684}, {"x": 0.82154134605062, "y": 8.401706239260813}, {"x": 1.1893601378034109, "y": 9.299080757245042}, {"x": 1.4331721862566797, "y": 10.66107268391537}, {"x": 0.973782964738247, "y": 7.595110835012439}, {"x": 0.6191796355334092, "y": 6.913214921455005}, {"x": 1.1548827456556947, "y": 8.68704784552239}, {"x": 0.8834156391374859, "y": 6.207029922187122}, {"x": 0.7193562052010725, "y": 6.401716310008782}, {"x": 0.6426638640176272, "y": 7.744445603072168}, {"x": 0.4164144803920453, "y": 6.999688202710314}, {"x": 0.9025172481236687, "y": 7.251604816903004}, {"x": 0.9836858205281078, "y": 9.14067972961345}, {"x": 1.7981526295874224, "y": 8.703841062378665}, {"x": 1.4587209220588824, "y": 8.019763717315335}, {"x": 1.540179545839391, "y": 8.388104123603247}, {"x": 0.7508784951239764, "y": 6.708196323699465}, {"x": 0.6874790704707687, "y": 6.394265474598878}, {"x": 1.3100704119986448, "y": 8.937525799224836}, {"x": 1.422075986420995, "y": 8.653289223784821}, {"x": 0.2270751504373525, "y": 6.980973526067366}, {"x": 0.2660573787471501, "y": 4.065076512588169}, {"x": 0.9120781152122479, "y": 6.7529242465071135}, {"x": 0.31947246031702026, "y": 6.315925134118427}, {"x": 1.9232838075492915, "y": 9.1562729198257}, {"x": 1.6752314897236196, "y": 11.496408335782988}, {"x": 1.0403213740758466, "y": 6.932946524909822}, {"x": 0.4365445154563088, "y": 5.759887352833437}, {"x": 0.26983744506479757, "y": 4.8694661736496245}, {"x": 1.9581406909677377, "y": 10.046489708537342}, {"x": 1.4140869913782863, "y": 9.351124441968537}, {"x": 1.7199511138913262, "y": 10.667662932166298}, {"x": 0.7743452556572781, "y": 6.460808420461355}, {"x": 0.5016680396634496, "y": 7.754473861717328}, {"x": 0.5988760378894045, "y": 6.717016867750814}, {"x": 1.7137910568100314, "y": 9.25164168916506}, {"x": 0.9459679811364421, "y": 6.956105553926309}, {"x": 1.3265540940322564, "y": 8.99830123158483}, {"x": 1.6114572148735704, "y": 10.072216266544332}, {"x": 0.5059610092994482, "y": 6.531431576526956}, {"x": 0.15914687794064974, "y": 3.8419112344411275}, {"x": 1.4655212100314303, "y": 8.352353752384975}, {"x": 1.922794955007211, "y": 11.38142374670918}, {"x": 1.9076094683353255, "y": 11.459033618329801}, {"x": 0.9809981037677993, "y": 8.969915750703189}, {"x": 1.2643841288655102, "y": 7.360961775537605}, {"x": 1.4659900396759846, "y": 7.556781818841236}, {"x": 1.8048190064959324, "y": 10.7805502456551}, {"x": 0.32449383749640015, "y": 5.641704377436392}, {"x": 0.8117626447351225, "y": 6.7460699561156146}, {"x": 0.8341814711673217, "y": 9.5371519750069}, {"x": 1.3911820565841477, "y": 8.62283175783785}, {"x": 0.8496944758496632, "y": 8.299536757875831}, {"x": 1.7162284521028595, "y": 8.84169301722776}, {"x": 1.693864959218838, "y": 10.662168213450787}, {"x": 0.14039822781737765, "y": 4.31667159078984}, {"x": 0.603504826968297, "y": 7.500635951129598}, {"x": 1.9592473620603403, "y": 11.564632152319426}, {"x": 0.07125399310606961, "y": 3.6470744497398178}, {"x": 0.9847852939971642, "y": 8.859330003458174}, {"x": 1.9047537060270927, "y": 11.493083517404346}, {"x": 1.6211475170589422, "y": 10.291675421773569}, {"x": 0.5886608825927424, "y": 6.874854637676141}, {"x": 1.1924670370366823, "y": 8.60568474593312}, {"x": 0.8623557045994599, "y": 7.008241289007391}, {"x": 1.1847950059779726, "y": 7.354933818739986}, {"x": 1.787504209440412, "y": 8.656560622583067}, {"x": 1.1080423795434124, "y": 8.693291095737242}, {"x": 0.9857330146905476, "y": 9.833772471033809}, {"x": 0.6385409143790024, "y": 6.538719392968032}, {"x": 0.526731566101448, "y": 8.41213078012988}, {"x": 1.0845612270715916, "y": 8.256701115245988}, {"x": 0.16452904786404798, "y": 5.417563677867521}, {"x": 1.271273419650797, "y": 8.81777785293999}, {"x": 1.5928104503724156, "y": 9.593417240220132}, {"x": 1.9094950108616178, "y": 8.241333497362083}], "data-fe04dd34dbf1c590d7ac876197c4c736": [{"x": 0.8057606627582843, "y": 7.319338103503201}, {"x": 0.7085966002126411, "y": 7.030377381425598}, {"x": 1.0012286388859064, "y": 7.900649403639013}, {"x": 0.8903532576622766, "y": 7.570911953602286}, {"x": 0.1808655763928717, "y": 5.4609335591885575}, {"x": 0.5471258400548813, "y": 6.550171982153747}, {"x": 1.8869541954854538, "y": 10.534749807554947}, {"x": 0.05308928266788393, "y": 5.080933699859622}, {"x": 0.07999737928130157, "y": 5.16095693914621}, {"x": 0.5662807194396391, "y": 6.607137568331547}, {"x": 1.1646883404335377, "y": 8.386769808162084}, {"x": 1.9817856058496541, "y": 10.816773346881583}, {"x": 1.9852844748059362, "y": 10.82717879590845}, {"x": 1.9862347449620896, "y": 10.830004848497204}, {"x": 0.22009666193312594, "y": 5.577604708053652}, {"x": 1.3289628919278802, "y": 8.875313532818314}, {"x": 1.0479736689766257, "y": 8.03966662147311}, {"x": 0.34629981961746203, "y": 5.952926144987276}, {"x": 1.8859204898300514, "y": 10.531675622256648}, {"x": 0.4837201719525046, "y": 6.361606918501032}, {"x": 1.997864537686424, "y": 10.864591229667276}, {"x": 1.1653876302997974, "y": 8.388849458800415}, {"x": 0.36655800126115157, "y": 6.013172893037666}, {"x": 0.7736908438355805, "y": 7.223964178308901}, {"x": 0.3793470578242992, "y": 6.051206862824}, {"x": 0.82154134605062, "y": 7.366269011079129}, {"x": 1.1893601378034109, "y": 8.46014241317849}, {"x": 1.4331721862566797, "y": 9.185226397179065}, {"x": 0.973782964738247, "y": 7.81902743753515}, {"x": 0.6191796355334092, "y": 6.7644561138009465}, {"x": 1.1548827456556947, "y": 8.357608494059198}, {"x": 0.8834156391374859, "y": 7.5502798473903745}, {"x": 0.7193562052010725, "y": 7.062375870838969}, {"x": 0.6426638640176272, "y": 6.8342969525065875}, {"x": 0.4164144803920453, "y": 6.1614433938016955}, {"x": 0.9025172481236687, "y": 7.607087010253687}, {"x": 0.9836858205281078, "y": 7.848478000682654}, {"x": 1.7981526295874224, "y": 10.270658702971264}, {"x": 1.4587209220588824, "y": 9.261206970162068}, {"x": 1.540179545839391, "y": 9.503460557860773}, {"x": 0.7508784951239764, "y": 7.156121474089996}, {"x": 0.6874790704707687, "y": 6.967574978120979}, {"x": 1.3100704119986448, "y": 8.819128308578396}, {"x": 1.422075986420995, "y": 9.152226892703522}, {"x": 0.2270751504373525, "y": 5.598358359397165}, {"x": 0.2660573787471501, "y": 5.714289420176984}, {"x": 0.9120781152122479, "y": 7.635520517305803}, {"x": 0.31947246031702026, "y": 5.873143014148655}, {"x": 1.9232838075492915, "y": 10.642792129579455}, {"x": 1.6752314897236196, "y": 9.905097811392022}, {"x": 1.0403213740758466, "y": 8.016909105966375}, {"x": 0.4365445154563088, "y": 6.221309040782899}, {"x": 0.26983744506479757, "y": 5.725531135107702}, {"x": 1.9581406909677377, "y": 10.746454635428645}, {"x": 1.4140869913782863, "y": 9.128468048993884}, {"x": 1.7199511138913262, "y": 10.038091580404814}, {"x": 0.7743452556572781, "y": 7.225910364044445}, {"x": 0.5016680396634496, "y": 6.414982916556607}, {"x": 0.5988760378894045, "y": 6.704074300996148}, {"x": 1.7137910568100314, "y": 10.01977190031307}, {"x": 0.9459679811364421, "y": 7.736307164879005}, {"x": 1.3265540940322564, "y": 8.868149896788466}, {"x": 1.6114572148735704, "y": 9.715436530998472}, {"x": 0.5059610092994482, "y": 6.427749978507034}, {"x": 0.15914687794064974, "y": 5.39634331231213}, {"x": 1.4655212100314303, "y": 9.281430662661133}, {"x": 1.922794955007211, "y": 10.641338308281249}, {"x": 1.9076094683353255, "y": 10.596177483601377}, {"x": 0.9809981037677993, "y": 7.840484874876145}, {"x": 1.2643841288655102, "y": 8.683259747535152}, {"x": 1.4659900396759846, "y": 9.282824936933663}, {"x": 1.8048190064959324, "y": 10.290484151132404}, {"x": 0.32449383749640015, "y": 5.888076321150882}, {"x": 0.8117626447351225, "y": 7.3371876766940005}, {"x": 0.8341814711673217, "y": 7.403860066714103}, {"x": 1.3911820565841477, "y": 9.060349998720454}, {"x": 0.8496944758496632, "y": 7.4499949124292755}, {"x": 1.7162284521028595, "y": 10.027020583471757}, {"x": 1.693864959218838, "y": 9.960512752462648}, {"x": 0.14039822781737765, "y": 5.3405858302178}, {"x": 0.603504826968297, "y": 6.717840071997679}, {"x": 1.9592473620603403, "y": 10.749745816032284}, {"x": 0.07125399310606961, "y": 5.1349545765812294}, {"x": 0.9847852939971642, "y": 7.85174777593906}, {"x": 1.9047537060270927, "y": 10.587684599328641}, {"x": 1.6211475170589422, "y": 9.744254971101466}, {"x": 0.5886608825927424, "y": 6.673694975828763}, {"x": 1.1924670370366823, "y": 8.469382165226184}, {"x": 0.8623557045994599, "y": 7.48764872913967}, {"x": 1.1847950059779726, "y": 8.446565955441985}, {"x": 1.787504209440412, "y": 10.238990871325996}, {"x": 1.1080423795434124, "y": 8.218307751999074}, {"x": 0.9857330146905476, "y": 7.854566246561975}, {"x": 0.6385409143790024, "y": 6.822035520929383}, {"x": 0.526731566101448, "y": 6.489520502857436}, {"x": 1.0845612270715916, "y": 8.148476061189685}, {"x": 0.16452904786404798, "y": 5.412349597626506}, {"x": 1.271273419650797, "y": 8.703748129636136}, {"x": 1.5928104503724156, "y": 9.659982051291703}, {"x": 1.9094950108616178, "y": 10.601784986165914}]}}, {"mode": "vega-lite"});
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_iterations</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">l_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.002</span><span class="p">]</span>
<span class="n">all_params</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># X,y = generate_data()</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">l_rates</span><span class="p">)):</span>
    <span class="n">initial_w_0</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">initial_w_1</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">learning_rate</span> <span class="o">=</span> <span class="n">l_rates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span> <span class="o">=</span> <span class="n">gradient_descent</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">initial_w_0</span><span class="p">,</span><span class="n">initial_w_1</span><span class="p">,</span><span class="n">learning_rate</span><span class="p">,</span><span class="n">num_iterations</span><span class="p">)</span>
    <span class="n">all_params</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;learning_rate: </span><span class="si">{:.4f}</span><span class="s2"> =&gt; w_0 = </span><span class="si">{}</span><span class="s2">, w_1 = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">learning_rate</span><span class="p">,</span><span class="n">w_0</span><span class="p">,</span><span class="n">w_1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>learning_rate: 0.0010 =&gt; w_0 = [3.7720079], w_1 = [3.84479659]
learning_rate: 0.0100 =&gt; w_0 = [4.83820114], w_1 = [3.0435688]
learning_rate: 0.1000 =&gt; w_0 = [4.92304901], w_1 = [2.97394648]
learning_rate: 0.0020 =&gt; w_0 = [4.08495606], w_1 = [3.66089023]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Graduate-Admission-Prediction">Graduate Admission Prediction<a class="anchor-link" href="#Graduate-Admission-Prediction"> </a></h2><p>We are going to use a dataset to predict the chance of getting admission in graduate school from the perspective of Indian students. The dataset is available at <a href="https://www.kaggle.com/mohansacharya/graduate-admissions">this link</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Content">Content<a class="anchor-link" href="#Content"> </a></h3><p>The dataset contains several parameters which are considered important during the application for Masters Programs.
The parameters included are :</p>
<ul>
<li><p>GRE Scores ( out of 340 )</p>
</li>
<li><p>TOEFL Scores ( out of 120 )</p>
</li>
<li><p>University Rating ( out of 5 )</p>
</li>
<li><p>Statement of Purpose and Letter of Recommendation Strength ( out of 5 )</p>
</li>
<li><p>Undergraduate GPA ( out of 10 )</p>
</li>
<li><p>Research Experience ( either 0 or 1 )</p>
</li>
<li><p>Chance of Admit ( ranging from 0 to 1 )</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Acknowledgements">Acknowledgements<a class="anchor-link" href="#Acknowledgements"> </a></h3><p>This dataset is inspired by the UCLA Graduate Dataset. The test scores and GPA are in the older format.
The dataset is owned by Mohan S Acharya.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Let's-code-it-up!">Let's code it up!<a class="anchor-link" href="#Let's-code-it-up!"> </a></h3><p>We are using <a href="https://github.com/apple/turicreate">Turi Create library</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">turicreate</span> <span class="k">as</span> <span class="nn">tc</span>
<span class="kn">import</span> <span class="nn">os</span>


<span class="c1"># Load the data</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span><span class="s2">&quot;admission_predict.csv&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">SFrame</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Finished parsing file /Users/mehdi/git_repos/ml_tutorial/data/admission_predict.csv</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Parsing completed. Parsed 100 lines in 0.036391 secs.</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>------------------------------------------------------
Inferred types from first 100 line(s) of file as 
column_type_hints=[int,int,int,int,float,float,float,int,float]
If parsing fails due to incorrect types, you can correct
the inferred type list above and pass it to read_csv in
the column_type_hints argument
------------------------------------------------------
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Finished parsing file /Users/mehdi/git_repos/ml_tutorial/data/admission_predict.csv</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Parsing completed. Parsed 500 lines in 0.005148 secs.</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Split the data into train and test sets</span>
<span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">random_split</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create the model and automatically pick the right model for the data</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">linear_regression</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;Chance of Admit&quot;</span><span class="p">,</span> 
                                                <span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GRE Score&quot;</span><span class="p">,</span><span class="s2">&quot;TOEFL Score&quot;</span><span class="p">,</span><span class="s2">&quot;University Rating&quot;</span><span class="p">,</span><span class="s2">&quot;SOP&quot;</span><span class="p">,</span><span class="s2">&quot;LOR&quot;</span> <span class="p">,</span><span class="s2">&quot;CGPA&quot;</span><span class="p">,</span><span class="s2">&quot;Research&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>PROGRESS: Creating a validation set from 5 percent of training data. This may take a while.
          You can set ``validation_set=None`` to disable validation tracking.

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Linear regression:</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>--------------------------------------------------------</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Number of examples          : 382</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Number of features          : 7</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Number of unpacked features : 7</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Number of coefficients    : 8</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Starting Newton Method</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>--------------------------------------------------------</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+-----------+----------+--------------+--------------------+----------------------+---------------------------------+-----------------------------------+</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| Iteration | Passes   | Elapsed Time | Training Max Error | Validation Max Error | Training Root-Mean-Square Error | Validation Root-Mean-Square Error |</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+-----------+----------+--------------+--------------------+----------------------+---------------------------------+-----------------------------------+</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 1         | 2        | 1.008480     | 0.263005           | 0.161696             | 0.060754                        | 0.058639                          |</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+-----------+----------+--------------+--------------------+----------------------+---------------------------------+-----------------------------------+</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>SUCCESS: Optimal solution found.</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre></pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">coefficients</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">name</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">index</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">value</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">stderr</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">(intercept)</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">-1.2194234077908317</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.12345599580590878</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">GRE Score</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.001618826787445662</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.0005996922897142088</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">TOEFL Score</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.002719675267851057</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.0010471136127637685</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">University Rating</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.0055687118093857325</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.004480660941075841</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOP</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.003933393122657006</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.005291439585231497</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">LOR</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.01230804029449188</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.004900628289324322</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">CGPA</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.12190995423260485</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.011405325159564978</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">Research</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">None</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.030518127884338626</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.007681798415697063</td>
    </tr>
</table>
[8 rows x 4 columns]<br/>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Do the prediction and save them into an array</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Evaluate the model and save the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;max_error&#39;: 0.16061435621560105, &#39;rmse&#39;: 0.05529337777075813}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

